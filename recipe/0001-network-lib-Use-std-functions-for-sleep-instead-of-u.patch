From 36478e7fd3a8f06eac162d394eebc34115445209 Mon Sep 17 00:00:00 2001
From: Ryan Volz <ryan.volz@gmail.com>
Date: Thu, 1 Oct 2020 16:05:00 -0400
Subject: [PATCH 1/2] network: lib: Use std functions for sleep instead of
 usleep.

This fixes compilation with MSVC.
---
 gr-network/lib/tcp_sink_impl.cc | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/gr-network/lib/tcp_sink_impl.cc b/gr-network/lib/tcp_sink_impl.cc
index 0c596d1d3..8d164697a 100644
--- a/gr-network/lib/tcp_sink_impl.cc
+++ b/gr-network/lib/tcp_sink_impl.cc
@@ -15,7 +15,9 @@
 #include "tcp_sink_impl.h"
 #include <gnuradio/io_signature.h>
 
+#include <chrono>
 #include <sstream>
+#include <thread>
 
 namespace gr {
 namespace network {
@@ -112,7 +114,7 @@ void tcp_sink_impl::run_listener()
             connect(d_initial_connection);
             d_initial_connection = false;
         } else
-            usleep(10);
+            std::this_thread::sleep_for(std::chrono::microseconds(10));
     }
 
     d_thread_running = false;
@@ -208,7 +210,7 @@ bool tcp_sink_impl::stop()
 
     if (d_listener_thread) {
         while (d_thread_running)
-            usleep(5);
+            std::this_thread::sleep_for(std::chrono::microseconds(5));
 
         delete d_listener_thread;
         d_listener_thread = NULL;
-- 
2.20.1

